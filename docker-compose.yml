# Homelab WhatsApp - Docker Compose Configuration

services:
  whatsapp-api:
    build: ./backend
    container_name: whatsapp-api
    restart: unless-stopped
    volumes:
      - whatsapp_auth:/app/wwebjs_auth
      - puppeteer_cache:/app/.cache/puppeteer
    ports:
      - "3008:3008"
    environment:
      - PORT=3008
      - DEBUG=true
    # Increase shared memory for Chromium
    shm_size: '2gb'

  whatsapp-ui:
    build: ./frontend
    container_name: whatsapp-ui
    restart: unless-stopped
    ports:
      - "3009:3000"
    environment:
      # Backend URL for API proxy (internal Docker network)
      - BACKEND_URL=http://whatsapp-api:3008
      # WebSocket port (client connects directly to backend)
      - NEXT_PUBLIC_WS_PORT=3008
    depends_on:
      - whatsapp-api

volumes:
  whatsapp_auth:
  puppeteer_cache:
